<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.120">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-10-10">

<title>Activity 4: Diving Penguins</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="activity4-diving-penguins_files/libs/clipboard/clipboard.min.js"></script>
<script src="activity4-diving-penguins_files/libs/quarto-html/quarto.js"></script>
<script src="activity4-diving-penguins_files/libs/quarto-html/popper.min.js"></script>
<script src="activity4-diving-penguins_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="activity4-diving-penguins_files/libs/quarto-html/anchor.min.js"></script>
<link href="activity4-diving-penguins_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="activity4-diving-penguins_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="activity4-diving-penguins_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="activity4-diving-penguins_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="activity4-diving-penguins_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Activity 4: Diving Penguins</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 10, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="terminology-review" class="level1">
<h1>Terminology review</h1>
<p>In today’s activity, we will use simulation-based methods for conducting a hypothesis test for a linear regression slope or correlation. Some terms covered in this activity are:</p>
<ul>
<li>Correlation</li>
<li>Slope</li>
<li>Regression line</li>
</ul>
</section>
<section id="diving-penguins" class="level1">
<h1>Diving Penguins</h1>
<p>Emperor penguins are the most accomplished divers among birds, making routine dives of 5–12 minutes, with the longest recorded dive over 27 minutes. These birds can also dive to depths of over 500 meters! Since air-breathing animals like penguins must hold their breath while submerged, the duration of any given dive depends on how much oxygen is in the bird’s body at the beginning of the dive, how quickly that oxygen gets used, and the lowest level of oxygen the bird can tolerate. The rate of oxygen depletion is primarily determined by the penguin’s heart rate. Consequently, studies of heart rates during dives can help us understand how these animals regulate their oxygen consumption in order to make such impressive dives.</p>
<p>In this study, the researchers equipped emperor penguins with devices that record their heart rates during dives. The data set reports Dive Heart Rate (beats per minute), the Duration (minutes) of dives, and other related variables. Is there an association between dive heart rate and the duration of the dive?</p>
<section id="vocabulary-review" class="level2">
<h2 class="anchored" data-anchor-id="vocabulary-review">Vocabulary review</h2>
<p><strong>1. In this study, which variable will be on the <span class="math inline">\(x\)</span>-axis? Is it the response variable or the explanatory variable? Is it quantitative or categorical?</strong></p>
<p><strong>2. Which variable is on the <span class="math inline">\(y\)</span>-axis? Is it the response variable or the explanatory variable? Is it quantitative or categorical?</strong></p>
<p><strong>3. How is this study different from other studies we have considered?</strong> <em>(Hint: consider the number and types of variables.)</em></p>
</section>
</section>
<section id="exploratory-data-analysis" class="level1">
<h1>Exploratory Data Analysis</h1>
<section id="visualizing-the-relationship---scatterplot" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-the-relationship---scatterplot">Visualizing the Relationship - Scatterplot</h2>
<p>A <em>scatterplot</em> is a graph showing a dot for each observational unit, where the location of the dot indicates the values of the observational unit for both the explanatory and response variables. Typically, the explanatory variable is placed on the <span class="math inline">\(x\)</span>-axis and the response variable is placed on the <span class="math inline">\(y\)</span>-axis.</p>
<p>When describing a relationship or association between two quantitative variables as seen through a scatterplot, we look for four aspects of association: form, direction, strength, and unusual observations.</p>
<ul>
<li><p>The <strong>form</strong> of association between two quantitative variables is described by indicating whether a line would do a reasonable job summarizing the overall pattern in the data or if a curve would be better. It is important to note that, especially when the sample size is small, you don’t want to let one or two points on the scatterplot change your interpretation of whether or not the form of association is linear. In general, assume that the form is linear unless there is compelling (strong) evidence in the scatterplot that the form is not linear.</p></li>
<li><p>The <strong>direction</strong> of association between two quantitative variables is either positive or negative, depending on whether or not the response variable (<code>Duration</code>) tends to increase (positive association) or decrease (negative association) as the explanatory variable (<code>Dive_HeartRate</code>) increases.</p></li>
<li><p>In describing the <strong>strength</strong> of association revealed in a scatterplot, we see how closely the points follow a straight line or curve. If all the points fall pretty close to this straight line or curve, we say the association is strong. Weak associations will show little pattern in the scatterplot, and moderate associations will be somewhere in the middle.</p></li>
<li><p>When exploring the relationship and describing a scatterplot which visualizes two quantitative variables, we look for <strong>unusual observations</strong> or apparent <strong>outliers</strong>. Points which fall far from the trend of other points have the potential to be high leverage or high influential points.</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="activity4-diving-penguins_files/figure-html/eda-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>4. Describe the association between the variables as revealed in the scatterplot above.</strong> <em>(Hint: Remember to comment on direction, strength, and form of association as well as unusual observations. Also, make sure you use the context of the study)</em></p>
</section>
<section id="summarizing-the-relationship---correlation" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-the-relationship---correlation">Summarizing the Relationship - Correlation</h2>
<p>Describing the direction, form, and strength of association based on a scatterplot, along with investigating unusual observations, is an important first step in summarizing the relationship between two quantitative variables. Another approach is to use a summary statistic. One of the statistics most commonly used for this purpose is the <strong>correlation coefficient</strong>. When the relationship has a roughly linear form, it’s strength and direction can be quantified by the correlation.</p>
<p>The sample correlation coefficient, denoted <span class="math inline">\(r\)</span>, is a single number that takes a value between -1 and 1, inclusive. Negative values of <span class="math inline">\(r\)</span> indicate a negative association, whereas positive values of <span class="math inline">\(r\)</span> indicate a positive association. It is important to note that the correlation coefficient within a population is denoted <span class="math inline">\(\rho\)</span> and <span class="math inline">\(r\)</span> is an estimate of <span class="math inline">\(\rho\)</span>.</p>
</section>
<section id="some-key-ideas-to-remember" class="level2">
<h2 class="anchored" data-anchor-id="some-key-ideas-to-remember">Some key ideas to remember</h2>
<ul>
<li>Correlation measures the relationship between a pair of variables; the correlation is the same regardless of which one is explanatory and which is response. <em>(Be careful, the same is not true for regression coefficients!)</em></li>
<li>Correlation is a number without units. It is not a percent!</li>
<li>The stronger the linear association is between the two variables, the closer the value of the correlation coefficient will be to either -1 or 1, whereas weaker linear associations will have correlation coefficient values closer to 0. Moderate linear associations will typically have correlation coefficients in the range of 0.3 to 0.7, or -0.3 to -0.7.</li>
<li>Correlation can be sensitive to outliers and extreme values of either variable.</li>
</ul>
</section>
<section id="calculating-the-correlation" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-correlation">Calculating the Correlation</h2>
<p>The correlation coefficient uses a rather complex formula that is rarely computed by hand; instead, people almost always use a calculator or computer to calculate the value of the correlation coefficient. We will use the <strong>moderndive</strong> <code>R</code> package to obtain the correlation between two numerical variables. Specifically, we will use the <code>get_correlation()</code> function to obtain our sample correlation coefficient.</p>
<p>The code will always look something like this:</p>
<pre><code>get_correlation(data = &lt;NAME OF DATASET&gt;, 
                &lt;Y-VARIABLE&gt; ~ &lt;X-VARIABLE&gt;)</code></pre>
<p>You will be responsible for (1) filling in the name of the data set and (2) filling in the names of the <span class="math inline">\(x\)</span>-variable and <span class="math inline">\(y\)</span>-variable.</p>
<p>I’ve filled in the code for you to obtain our sample correlation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_correlation</span>(<span class="at">data =</span> diving, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                Duration <span class="sc">~</span> Dive_HeartRate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
     cor
   &lt;dbl&gt;
1 -0.846</code></pre>
</div>
</div>
<p><strong>5. Interpret the correlation obtained. Is it positive or negative? What does this imply about the relationship between the variables? Is it strong, moderate, or weak? How does this connect to what you saw in the scatterplot?</strong></p>
<!-- Move to concept check -->
<!-- ## Extra Practice with Correlations -->
<!-- ```{r, fig.align = 'center'} -->
<!-- knitr::include_graphics("correlations.png") -->
<!-- ``` -->
<!-- **6. Assign the following values of r, the correlation coefficient, to the data sets above.** -->
<!-- \begin{center} -->
<!-- -0.21, 0.83, -0.97, -0.5 -->
<!-- \end{center} -->
<!-- \vspace{0.5cm} -->
<p><strong>6. Say you had another observation at (100, 15), as in a penguin with a heart rate of 100 beats per minute who dove for 15 minutes. How do you think this would change the correlation coefficient?</strong></p>
</section>
</section>
<section id="least-squares-regression" class="level1">
<h1>Least Squares Regression</h1>
<p><strong>7. If you knew the heart rate of a penguin, what might be a way to determine how long you would expect for them to dive for based on the data?</strong></p>
<p>Correlation measures strength of the association between two quantitative variables when the sample data points tend to follow a straight line. A natural question is then: what line do the points tend to follow?</p>
<p><strong>8. Based on the scatterplot, would you say that a straight line could summarize the relationship between dive duration and heart rate reasonably well?</strong></p>
<p><strong>9. Using the scatterplot below, draw the line you believe fits the data the best. How did you decide where to draw your line? Is your line the same as your group members?</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="activity4-diving-penguins_files/figure-html/draw-line-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<section id="finding-the-best-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="finding-the-best-regression-line">Finding the “Best” Regression Line</h2>
<p>Your regression line will be different from my regression line and from other people in our class. There may be similarities, but no one will draw the exact same line! So, how then do we decide what line is the “best”?</p>
<p>In statistics we use a method called “least squares.” The idea is that we minimize the sum of the squared distances between each point and the line. That’s a mouthful! Let’s visualize what this means.</p>
<p><strong>10. On your plot, draw the vertical distance between some (not all!) of the points and the line you drew.</strong></p>
<p>These vertical distances are how far off your estimated duration is from what was actually seen in the data. These values are called <strong>residuals</strong>. The least squares method finds the line that minimizes the <em>square</em> of these residuals.</p>
<p><strong>11. When you square small residuals what happens?</strong> <em>Hint: What happens if you square positive number? A negative number?</em></p>
<p><strong>12. When you square large residuals what happens?</strong></p>
<p><strong>13. When you square a number between 0 and 1 what happens?</strong></p>
</section>
<section id="obtaining-coefficient-estimates-from-r" class="level2">
<h2 class="anchored" data-anchor-id="obtaining-coefficient-estimates-from-r">Obtaining Coefficient Estimates from <code>R</code></h2>
<p>We will always use <code>R</code> to find the equation of the “best” regression line. Specifically, we will use the <code>lm()</code> function. The <code>lm</code> stands for <em>linear model</em> - the method we believe best models the relationship between our two variables.</p>
<p>The code will always look something like:</p>
<pre><code>name_of_lm &lt;- lm(&lt;Y-VARIABLE&gt; ~ &lt;X-VARIABLE&gt;, 
                 data = &lt;NAME OF DATASET&gt;)</code></pre>
<p>In the context of these data, here is the code I used to find the regression line:</p>
<p><em>Note: We named our linear regression model <code>diving_lm</code>.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>diving_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Duration <span class="sc">~</span> Dive_HeartRate,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> diving)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once we’ve told <code>R</code> to find the regression line, we need to obtain the estimated coefficients that go with the line! To do this, we will use the <code>get_regression_table()</code> function from the moderndive package.</p>
<p><em>Note: We can use this function on the linear regression model we named above.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_regression_table</span>(diving_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term           estimate std_error statistic p_value lower_ci upper_ci
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 intercept        14.8       0.466      31.6       0   13.8     15.7  
2 Dive_HeartRate   -0.131     0.007     -17.6       0   -0.146   -0.116</code></pre>
</div>
</div>
<p><strong>14. Using the output from the <code>R</code> code above, write the equation of the regression line. Note that we’ve used variable names in the equation, not generic <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. And put a carat (“hat”) over the <span class="math inline">\(y\)</span>-variable name to emphasize that the line gives predicted values of the <span class="math inline">\(y\)</span> (response) variable.</strong></p>
<p><span class="math display">\[\widehat{\text{Dive Duration}} = \underline{\hspace{3cm}} + \underline{\hspace{3cm}} \times \text{(Heart Rate)}\]</span></p>
<p>Notation: The equation of the best fit line is written as <span class="math inline">\(\hat{y} = b_0 + b_1 \times \text{(x)}\)</span> where</p>
<ul>
<li><span class="math inline">\(b_0\)</span> is the intercept</li>
<li><span class="math inline">\(b_1\)</span> is the slope</li>
<li><span class="math inline">\(x\)</span> is a value of the explanatory variable</li>
<li><span class="math inline">\(\hat{y}\)</span> is the predicted value for the response variable</li>
</ul>
<p><strong>15. Is the slope positive or negative? Explain how the sign of the slope tells you about whether your data display a positive or a negative association.</strong></p>
</section>
<section id="interpreting-the-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-coefficients">Interpreting the Coefficients</h2>
<p>Let’s investigate what the slope means in the context of heart rate and dive duration.</p>
<p><strong>16. Use the least squares regression line to predict the diving duration for penguins with a heart rate of 75 beats per minute.</strong></p>
<p><strong>17. Use the least squares regression line to predict the diving duration for penguins with a heart rate of 76 beats per minute.</strong></p>
<p><strong>18. By how much do your predictions in #8 and #9 differ? Does this number look familiar? Explain.</strong></p>
<p><strong>19. These questions above were designed to help you interpret the slope. Interpret the slope in context:</strong></p>
<p>The slope of the regression line predicting dive duration based on heart rate is , meaning that for every beat per minute increase in heart rate, the predicted dive duration (increases / decreases) by minutes.</p>
<p>Let’s investigate the meaning of the <span class="math inline">\(y\)</span>-intercept in the context of dive duration and heart rate.</p>
<p><strong>19. Use the least squares regression line to predict the diving duration for a penguin with a heart rate of 0 beats per minute.</strong></p>
<p><strong>20. Your answer to #12 should look familiar. What is this value?</strong></p>
</section>
<section id="be-cautious" class="level2">
<h2 class="anchored" data-anchor-id="be-cautious">Be cautious!</h2>
<p>While we can make predictions using our least squares regression line, we should always be wary of extrapolation in interpreting the intercept or other values outside the original data range.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="extrapolating.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p><strong>21. What was the lowest value of heart rate observed in these data?</strong></p>
<p><strong>22. What heart rates do you believe would be an extrapolation?</strong></p>
</section>
<section id="coefficient-of-determination" class="level2">
<h2 class="anchored" data-anchor-id="coefficient-of-determination">Coefficient of Determination</h2>
<p>A quantity related to the correlation coefficient (r) is called the coefficient of determination or R-squared (<span class="math inline">\(R^2\)</span>). The coefficient of determination (<span class="math inline">\(R^2\)</span>) is the percentage of total observed variation in the response variable that is accounted for by changes (variability) in the explanatory variable.</p>
<p>Keep in mind that <span class="math inline">\(R^2\)</span>, like correlation, requires that the relationship between the explanatory and response variables is linear!</p>
<p><span class="math inline">\(R^2\)</span> values are reported as proportions, but can also be thought of as a percent. Values close to 1 or 100% indicate that the explanatory variable is able to explain a large portion of the variability in the response.</p>
<p>We calculate <span class="math inline">\(R^2\)</span> by squaring the correlation (r).</p>
<p><strong>23. Calculate the coefficient of determination (<span class="math inline">\(R^2\)</span>) for the relationship between heart rate and dive duration.</strong> <em>Hint: Look back at question 5.</em></p>
<p><strong>24. Complete the following statement to interpret what this value means in the context of the data:</strong></p>
<p>The coefficient of determination is %, this means that % of the variation in penguin’s is attributable to changes in their .</p>
</section>
<section id="recall-the-context-of-todays-exploration" class="level2">
<h2 class="anchored" data-anchor-id="recall-the-context-of-todays-exploration">Recall the Context of Today’s Exploration</h2>
<p>Let’s remember what the purpose of this study was. For the penguin study, researchers equipped emperor penguins with devices that record their heart rates during dives. The data we analyzed contained Dive Heart Rate (beats per minute), the Duration (minutes) of dives, and other related variables. <em>These researchers were interested in studying if there was evidence of an association between a penguin’s dive heart rate and the duration of their dive?</em></p>
<p><strong>25. Write out the null and alternative hypothesis in words.</strong></p>
<p><strong>26. Using the research question, rewrite the hypotheses using notation. Use the slope as the summary measure.</strong> <em>Hint: What is the symbol for the population slope?</em></p>
</section>
<section id="inference-for-the-slope-coefficient" class="level2">
<h2 class="anchored" data-anchor-id="inference-for-the-slope-coefficient">Inference for the Slope Coefficient</h2>
<p><strong>27. Based on the slope coefficient you reported in question 14, do you think there is convincing evidence of an association between a penguin’s heart rate and the duration of their dive?</strong></p>
</section>
</section>
<section id="hypothesis-testing" class="level1">
<h1>Hypothesis Testing</h1>
<p>In a hypothesis test we are interested in comparing two things:</p>
<ul>
<li>what we observed in our data (our observed slope)</li>
<li>what would have happened if the null hypothesis was true</li>
</ul>
<p>In order to compare what we saw in this study to what would have happened if the null hypothesis was true, we need to generate a distribution of slopes that we would have expected to see if the null was true. This is called our <strong>null distribution</strong>. We then see where our observed slope falls on that distribution.</p>
<p>If our observed statistic falls in the middle of the distribution, then it is fairly likely to happen if the null is true. However, if our observed statistic falls in the tails of the distribution, then it is unlikely to happen if the null is true.</p>
<section id="simulation-based-methods" class="level2">
<h2 class="anchored" data-anchor-id="simulation-based-methods">Simulation-Based Methods</h2>
<p>Similar to what we talked about with confidence intervals and bootstrapping, a null distribution is also a <em>sampling distribution</em>. It is, however, a special type of sampling distribution. It is a distribution of sample statistics that could have been observed <strong>if the null hypothesis was true</strong>.</p>
<p>Much like we used a bootstrap or a <span class="math inline">\(t\)</span>-distribution to approximate the true sampling distribution, there are two ways to approximate the true null distribution:</p>
<ol type="1">
<li><p>using simulation or</p></li>
<li><p>using a <span class="math inline">\(t\)</span>-distribution.</p></li>
</ol>
<p>In this activity we will focus on option 1, but in the lab we will focus on option 2.</p>
<section id="simulating-what-could-have-happened-under-the-null-hypothesis" class="level3">
<h3 class="anchored" data-anchor-id="simulating-what-could-have-happened-under-the-null-hypothesis">Simulating what could have happened under the null hypothesis</h3>
<p>Let’s start by thinking about how one simulation would be created on the null distribution using cards.</p>
<ul>
<li>Step 1: Write each penguin’s heart rate and dive duration on 125 cards - (<span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span>) pairs.</li>
</ul>
<ul>
<li>Step 2: Assume the null hypothesis is true - rip apart the pairs and make a pile of heart rate values and a pile of dive duration values.</li>
</ul>
<ul>
<li>Step 3: Generate a new sample - match a randomly drawn heart rate with a randomly drawn dive duration until all cards have a random match (this is called permuting).</li>
</ul>
<ul>
<li>Step 4: Calculate the statistic of interest - calculate the slope from the linear regression line fit on the randomly matched pairs of heart rate and dive duration.</li>
</ul>
<ul>
<li>Step 5: Repeat and plot the statistic of interest from each random permutation on a dot-plot to create your null distribution. </li>
</ul>
</section>
<section id="how-do-we-do-this-in-r" class="level3">
<h3 class="anchored" data-anchor-id="how-do-we-do-this-in-r">How do we do this in <code>R</code>?</h3>
<p>We will use the <strong>infer</strong> package to help us simulate what could have happened if the null was true. The layout for the code looks similar to what you saw in last week’s activity, so let’s try and fill in what is missing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>diving <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> ___________, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">explanatory =</span>  ___________) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesise</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span>  ___________, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span>  ___________) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">" ___________"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>28. What inputs should be entered for each of the following to create the simulation to test regression slope?</strong></p>
<ul>
<li>Response variable (choose <code>Duration</code> or <code>Dive_HeartRate</code>):</li>
</ul>
<ul>
<li>Explanatory variable (choose <code>Duration</code> or <code>Dive_HeartRate</code>):</li>
</ul>
<ul>
<li>Number of repetitions:</li>
</ul>
<ul>
<li>Type of method to use when generating new samples (choose <code>"permute"</code> or <code>"bootstrap"</code>):</li>
</ul>
<ul>
<li>Summary measure (choose <code>"slope"</code> or <code>"correlation"</code>):</li>
</ul>
<p><strong>29. Suppose we wanted to complete the simulation test using correlation as the summary measure, instead of slope. Which input(s) in #4 would need to be changed to test for correlation? What input(s) should you use instead?</strong></p>
<p>Here is a preview of what the output of this code looks like for 5000 permutations:</p>
<p><em>Note: We name the values in our null distribution (plotted in the next histogram), <code>null_dist</code></em></p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(null_dist) <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: right;">replicate</th>
<th style="text-align: right;">stat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">-0.003</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">-0.008</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.012</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong>30. What does the <code>replicate</code> column represent?</strong></p>
<p><strong>31. What does the <code>stat</code> column represent?</strong></p>
</section>
</section>
<section id="visualizing-the-null-distribution" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-the-null-distribution">Visualizing the Null Distribution</h2>
<p>Below is a null distribution of slope statistics, generated using the code you completed above. I chose to use 5000 reps, which might be slightly different from what you chose.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="activity4-diving-penguins_files/figure-html/null-viz-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>32. Why is the distribution centered at 0?</strong></p>
<p><strong>33. Mark where the observed slope lies on the distribution.</strong></p>
<p><strong>34. Shade or circle what area you will use to calculate the p-value.</strong></p>
<p><strong>35. Estimate what p-value we will obtain from <code>R</code>.</strong></p>
</section>
<section id="calculating-the-p-value" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-p-value">Calculating the p-value</h2>
<p>Since our distribution consists of 5000 slope statistics, we will need to use <code>R</code> to find our p-value. To find a p-value, <code>R</code> needs to first know what our observed statistic is. We can actually do this using some of the code from before!</p>
<p>What I’m doing in the code below is:</p>
<ul>
<li>making a new object named <code>obs_stat</code> that contains the number for the observed slope</li>
<li>using the <code>diving</code> data set</li>
<li><code>specifying</code> what variables to use</li>
<li><code>calclating</code> the statistic we are interested in</li>
</ul>
<p><em>Note: we name this value in R, <code>obs_slope</code>.</em></p>
<div class="cell" data-messages="false" data-warnings="false">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>obs_slope <span class="ot">&lt;-</span> diving <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(<span class="at">response =</span> Duration, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">explanatory =</span> Dive_HeartRate) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate</span>(<span class="at">stat =</span> <span class="st">"slope"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>obs_slope</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Response: Duration (numeric)
Explanatory: Dive_HeartRate (numeric)
# A tibble: 1 × 1
    stat
   &lt;dbl&gt;
1 -0.131</code></pre>
</div>
</div>
<p>The next part is to compare this <code>obs_stat</code> to the distribution of shuffled slope statistics (stored in <code>null_dist</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p_value</span>(null_dist, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">obs_stat =</span> __________, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">direction =</span> <span class="st">"_________"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>36. What inputs should be entered for each of the following to calculate the p-value?</strong></p>
<ul>
<li><code>obs_stat =</code></li>
</ul>
<ul>
<li><code>direction =</code> (<code>"greater"</code>, <code>"less"</code>, or <code>"two-sided"</code>):</li>
</ul>
<p>Using your inputs, I obtained the p-value for our observed slope statistic. The p-value is:</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Please be cautious in reporting a p-value of 0. This result is an
approximation based on the number of `reps` chosen in the `generate()` step. See
`?get_p_value()` for more information.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
</div>
</div>
<p><strong>37. Why did I get a warning message from <code>R</code>? What does the warning tell me?</strong></p>
</section>
<section id="communicate-the-results-and-answer-the-research-question" class="level2">
<h2 class="anchored" data-anchor-id="communicate-the-results-and-answer-the-research-question">Communicate the results and answer the research question</h2>
<p><strong>38. Based on the p-value and an <span class="math inline">\(\alpha = 0.05\)</span>, write a conclusion in context of the problem.</strong></p>
<p><strong>39. Based on the p-value you obtained for testing the slope, what p-value do you think you would get if you tested the correlation instead?</strong> <em>Hint: think about the relationship between slope and correlation!</em></p>
</section>
<section id="connection-to-confidence-intervals" class="level2">
<h2 class="anchored" data-anchor-id="connection-to-confidence-intervals">Connection to Confidence Intervals</h2>
<p><strong>40. If you were to make a 95% confidence interval for the true slope (<span class="math inline">\(\beta_1\)</span>), would the interval contain 0? Why or why not?</strong></p>
<div style="page-break-after: always;"></div>
<section id="take-home-messages" class="level3">
<h3 class="anchored" data-anchor-id="take-home-messages">Take-home messages</h3>
<ol type="1">
<li><p>To create one simulated sample on the null distribution when testing for a relationship between two quantitative variables, we separate the <span class="math inline">\(x\)</span>-values from the <span class="math inline">\(y\)</span>-values. We then shuffle the <span class="math inline">\(y\)</span>-values and pair them with a new <span class="math inline">\(x\)</span>-value. Once we have a new dataset, we find the regression line for the shuffled data and plot the slope or the correlation for the shuffled data.</p></li>
<li><p>To obtain a p-value for the observed slope we need to carry out the following steps:</p></li>
</ol>
<ul>
<li><p>obtain a distribution of statistics that could have happened if the null was true (null distribution)</p></li>
<li><p>locate the observed slope on the null distribution</p></li>
<li><p>count how many shuffled slopes are as large or larger than the observed slope</p></li>
<li><p>divide the number of slopes by the total number of reps used (e.g., <span class="math inline">\(\frac{4}{1000}\)</span>)</p></li>
<li><p>multiply this by two, since we almost always have a two-sided alternative</p></li>
</ul>
<ol start="3" type="1">
<li>The p-value for a test for correlation should be approximately the same as the p-value for the test of slope. In the simulation test, we just change the statistic type from slope to correlation and use the appropriate sample statistic value.</li>
</ol>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>