---
title: 'Week 4 Day 2: Inferences for Diving Penguins'
output:
  html_document: default
  pdf_document: default
---

```{r setup, include = FALSE}
library(tidyverse)
library(mosaic)
library(infer)
library(moderndive)

set.seed(1234)

my_theme <- theme(axis.text = element_text(size = 16), 
                  axis.title = element_text(size = 18)
                  )

```


## Drawing Inference from the Data

In this activity, we will focus on using simulation-based methods for inference
in regression.  

4. Write out the null hypothesis __in words__.

\vspace{1in}

5. Using the research question, rewrite the hypotheses using notation. Use the
slope as the summary measure.

\vspace{0.5in}


#### Simulation-based hypothesis test

Let's start by thinking about how one simulation would be created on the null distribution using cards.  First, we would write the values for the response variable, Duration, on each card.  Next, we would shuffle these $y$ values while keeping the $x$ values (explanatory variable) in the same order.  Then, find the line of regression for the shuffled $(x, y)$ pairs and calculate either the slope or correlation of the shuffled sample.  

We will use the `regression_test()` function in `R` (in the `catstats` package) to simulate the null distribution of shuffled slopes (or shuffled correlations) and compute a p-value.  We will need to enter the response variable name and the explanatory variable name for the formula, the data set name (identified above as `diving`), the summary measure for the test (either slope or correlation), number of repetitions, the sample statistic (value of slope or correlation), and the direction of the alternative hypothesis.

The response variable name is `Duration` and the explanatory variable name is `Dive_HeartRate` for these data.

\newpage

8. What inputs should be entered for each of the following to create the simulation to test regression slope?

\vspace{.5 mm}

* Direction (`"greater"`, `"less"`, or `"two-sided"`):

\vspace{.2in}

* Summary measure (choose `"slope"` or `"correlation"`):

\vspace{.2in}
* As extreme as (enter the value for the sample slope):

\vspace{0.2in}

* Number of repetitions:
    
\vspace{.2in}

Using the `R` script file for this activity, enter your answers for question 8 in place of the `xx`'s to produce the null distribution with 1000 simulations.  Highlight and run lines 22--27.

```{r, echo=TRUE, eval=FALSE}
regression_test(Duration ~ Dive_Heartrate, # response ~ explanatory
               data = diving, # Name of data set
               direction = "xx", # Sign in alternative ("greater", "less", "two-sided")
               summary_measure = "xx", # "slope" or "correlation"
               as_extreme_as = x, # Observed slope or correlation
               number_repetitions = 1000) # Number of simulated samples for null distribution
```

9.  Report the p-value from the `R` output. 
\vspace{0.5in}

10.  Suppose we wanted to complete the simulation test using correlation as the summary measure, instead of slope.  Which two inputs in #8 would need to be changed to test for correlation?  What inputs should you use instead?
\vspace{0.75in}

11.  Change the inputs in lines 22-27 to test for correlation instead of slope.  Highlight and run those lines, then report the new p-value of the test.
\vspace{0.5in}

12.  The p-values from the test of slope (#9) and the test of correlation (#11) should be similar.  Explain why the two p-values should match. *Hint: think about the relationship between slope and correlation!*
\vspace{1in}

#### Communicate the results and answer the research question {-}

15. Based on the p-value, write a conclusion in context of the problem.

\vspace{.8in}

16. Does the conclusion based on the p-value agree with the results of the 95\% confidence interval?  What does each tell you about the null hypothesis?

\vspace{.6in}

### Connection to Confidence Intervals



### Take-home messages

1.	The p-value for a test for correlation should be approximately the same as
the p-value for the test of slope.  In the simulation test, we just change the
statistic type from slope to correlation and use the appropriate sample
statistic value.  

2. To interpret a confidence interval for the slope, think about how to
interpret the sample slope and use that information in the confidence interval
interpretation for slope.  

3. To create one simulated sample on the null distribution when testing for a relationship between two quantitative variables, hold the $x$ values constant
and shuffle the $y$ values to new $x$ values. Find the regression line for the
shuffled data and plot the slope or the correlation for the shuffled data.

<!-- 4. Something about hypothesis tests and confidence intervals -->